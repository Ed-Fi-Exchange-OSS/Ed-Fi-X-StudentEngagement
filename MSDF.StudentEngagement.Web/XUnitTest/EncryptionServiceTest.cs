using MSDF.StudentEngagement.Resources.Services.Encryption;
using System;
using Xunit;

namespace XUnitTest
{
    public class EncryptionServiceTest
    {
        [Theory]
        [InlineData("{\"ct\":{\"0\":231,\"1\":246,\"2\":182,\"3\":229,\"4\":115,\"5\":203,\"6\":168,\"7\":132,\"8\":195,\"9\":47,\"10\":170,\"11\":124,\"12\":211,\"13\":89,\"14\":59,\"15\":132,\"16\":110,\"17\":206,\"18\":94,\"19\":192,\"20\":214,\"21\":15,\"22\":132,\"23\":146,\"24\":93,\"25\":77,\"26\":110,\"27\":248,\"28\":105,\"29\":196,\"30\":17,\"31\":41,\"32\":136,\"33\":4,\"34\":146,\"35\":186,\"36\":46,\"37\":213,\"38\":152,\"39\":215,\"40\":171,\"41\":168,\"42\":40,\"43\":241,\"44\":60,\"45\":138,\"46\":132,\"47\":67,\"48\":110,\"49\":124,\"50\":62,\"51\":252,\"52\":225,\"53\":237,\"54\":193,\"55\":94,\"56\":138,\"57\":250,\"58\":174,\"59\":170,\"60\":31,\"61\":7,\"62\":25,\"63\":6,\"64\":103,\"65\":211,\"66\":148,\"67\":248,\"68\":51,\"69\":119,\"70\":139,\"71\":96,\"72\":104,\"73\":0,\"74\":150,\"75\":83,\"76\":18,\"77\":197,\"78\":81,\"79\":243,\"80\":35,\"81\":228,\"82\":31,\"83\":204,\"84\":65,\"85\":142,\"86\":212,\"87\":33,\"88\":164,\"89\":204,\"90\":174,\"91\":111,\"92\":206,\"93\":186,\"94\":93,\"95\":112,\"96\":238,\"97\":211,\"98\":197,\"99\":87,\"100\":104,\"101\":254,\"102\":95,\"103\":100,\"104\":92,\"105\":239,\"106\":221,\"107\":92,\"108\":252,\"109\":31,\"110\":16,\"111\":192,\"112\":171,\"113\":207,\"114\":220,\"115\":84,\"116\":60,\"117\":213,\"118\":143,\"119\":224,\"120\":55,\"121\":217,\"122\":34,\"123\":250,\"124\":165},\"iv\":{\"0\":239,\"1\":211,\"2\":125,\"3\":91,\"4\":12,\"5\":103,\"6\":199,\"7\":127,\"8\":219,\"9\":148,\"10\":100,\"11\":182}}"
                    , "4Pmra8SUSrgdU3z/rc+Pf1pQzCK9mdb+jaVc+9cSmCE="
                    , "{\"IdentityEmailAddress\":\"\",\"ReffererUrl\":\"\",\"LeaningAppUrl\":\"\",\"UTCDateTimeStart\":\"2020-05-14T05:08:19.526Z\"}")]
        public void Decrypt_JSONEncryptionModel_Returns_JSONPayload(string jsonEncryptionModel, string exportedKey, string plainText)
        {
            IEncryptionService service = new EncryptionService();

            var decryptedText = service.Decrypt(jsonEncryptionModel, exportedKey);
            Assert.Equal(decryptedText, plainText);
        }
    }
}
